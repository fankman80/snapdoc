<?xml version="1.0" encoding="UTF-8"?>
<uranium:UraniumContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ff="clr-namespace:FFImageLoading.Maui;assembly=FFImageLoading.Maui"                             
             xmlns:views="clr-namespace:bsm24.Views"
             xmlns:uranium="http://schemas.enisn-projects.io/dotnet/maui/uraniumui"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:m="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols"
             Shell.TitleColor="{DynamicResource PrimaryDark}"
             BackgroundColor="{AppThemeBinding Light={DynamicResource PrimaryBackground}, Dark={DynamicResource PrimaryBackgroundDark}}"
             x:DataType="views:SetPin"                            
             x:Class="bsm24.Views.SetPin"
             Title="Pin bearbeiten">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackLayout Grid.Row="0" Margin="-5,-5,-5,10">
            <CollectionView x:Name="ImageGallery"
                            ItemsSource="{Binding Images}"
                            VerticalOptions="FillAndExpand">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" Span="{Binding DynamicSpan}" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <StackLayout>
                            <views:SquareView>
                                <ff:CachedImage Source="{Binding .}"
                                                Aspect="AspectFill"
                                                Margin="0,0,10,10">
                                    <ff:CachedImage.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnImageTapped" />
                                    </ff:CachedImage.GestureRecognizers>
                                </ff:CachedImage>
                            </views:SquareView>
                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </StackLayout>

        <StackLayout Grid.Row="1" Spacing="16" x:DataType="x:AppThemeBindingExtension">
            <material:TextField
                x:Name="PinTxt"
                TextColor="{AppThemeBinding {DynamicResource PrimaryText}, Dark={DynamicResource PrimaryDarkText}}"
                AccentColor="{DynamicResource Primary}"
                MaxLength="50"
                Title="Bezeichnung"
                Icon="{FontImageSource FontFamily=MaterialOutlined, Color={AppThemeBinding {DynamicResource Primary}, Dark={DynamicResource PrimaryDark}}, Glyph={x:Static m:MaterialOutlined.Push_pin}}"/>

            <material:EditorField
                x:Name="PinInfo"
                TextColor="{AppThemeBinding {DynamicResource PrimaryText}, Dark={DynamicResource PrimaryDarkText}}"
                AccentColor="{DynamicResource Primary}"
                Title="Beschreibung"
                Icon="{FontImageSource FontFamily=MaterialOutlined, Color={AppThemeBinding {DynamicResource Primary}, Dark={DynamicResource PrimaryDark}}, Glyph={x:Static m:MaterialOutlined.Info}}" />

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <VerticalStackLayout Grid.Column="0">
                    <Label Text="Pin sperren:" VerticalTextAlignment="Start" />
                    <Switch x:Name="LockSwitch"
                            ThumbColor="{DynamicResource Primary}"
                            OnColor="{DynamicResource PrimaryDark}"
                            HorizontalOptions="Start"/>
                </VerticalStackLayout>

                <VerticalStackLayout Grid.Column="1">
                    <Label Text="Rotation sperren:" VerticalTextAlignment="Start" />
                    <Switch x:Name="LockRotate"
                            ThumbColor="{DynamicResource Primary}"
                            OnColor="{DynamicResource PrimaryDark}"
                            HorizontalOptions="Start" />
                </VerticalStackLayout>

                <ImageButton Grid.Column="2"
                             Padding="8"
                             x:Name="PinImage"
                             Source="{Binding}"
                             Aspect="AspectFit"
                             HorizontalOptions="End"
                             WidthRequest="80"
                             HeightRequest="80"
                             CornerRadius="10"
                             BorderWidth="2"
                             BorderColor="LightGrey"
                             Background="White"
                             Clicked="OnPinSelectClick"/>
            </Grid>
        
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="{DynamicResource PrimaryDarkText}"                        
                        ImageSource="{FontImageSource FontFamily=MaterialOutlined, Glyph={x:Static m:MaterialOutlined.Check}}"
                        Clicked="OnOkayClick"/>
                <Button Grid.Column="1"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="{DynamicResource PrimaryDarkText}"
                        ImageSource="{FontImageSource FontFamily=MaterialOutlined, Glyph={x:Static m:MaterialOutlined.Photo_camera}}"
                        Clicked="TakePhoto"/>
                <Button Grid.Column="2"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="{DynamicResource PrimaryDarkText}"                        
                        ImageSource="{FontImageSource FontFamily=MaterialOutlined, Glyph={x:Static m:MaterialOutlined.Delete}}"
                        Clicked="OnDeleteClick"/>
            </Grid>
        </StackLayout>
    </Grid>

</uranium:UraniumContentPage>
