<?xml version="1.0" encoding="UTF-8"?>
<uranium:UraniumContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ff="clr-namespace:FFImageLoading.Maui;assembly=FFImageLoading.Maui" 
             xmlns:views="clr-namespace:bsm24.Views"
             xmlns:uranium="http://schemas.enisn-projects.io/dotnet/maui/uraniumui"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:m="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols"            
             xmlns:local="clr-namespace:bsm24"
             x:Name="IconGalleryPage"
             x:Class="bsm24.Views.IconGallery"
             x:DataType="views:IconGallery"
             BackgroundColor="White"
             Shell.TitleColor="{DynamicResource PrimaryDark}"
             Title="Pin auswählen">

    <Grid>
        <Grid Margin="10">
            <CollectionView x:Name="IconCollectionView"
                            ItemsSource="{Binding Icons}"
                            SelectionMode="Single">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid x:DataType="local:IconItem" HeightRequest="48">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <ff:CachedImage Grid.Column="0"
                                            Source="{Binding FileName}"
                                            CacheType="Memory"
                                            Aspect="AspectFill"
                                            Margin="6,6,6,6"/>
                            <Label Grid.Column="1"
                                   Text="{Binding DisplayName}"
                                   VerticalOptions="Center"
                                   Margin="16,0,0,0"
                                   LineBreakMode="WordWrap"/>
                            <Button Grid.ColumnSpan="2"
                                    AutomationId = "{Binding FileName}"
                                    Background="Transparent"
                                    Clicked="OnIconClicked"/>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Label Text="Gedrückt halten um Icon zu editieren."
                   FontSize="12"
                   VerticalOptions="Center"/>
        </Grid>

        <!-- Overlay für Busy-Indikator -->
        <local:BusyOverlayView x:Name="busyOverlay"
                               AbsoluteLayout.LayoutBounds="0,0,1,1"
                               AbsoluteLayout.LayoutFlags="All"/>
    </Grid>
</uranium:UraniumContentPage>
